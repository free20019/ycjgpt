{"version":3,"sources":["webpack:///./src/views/userManage/Record.vue?4614","webpack:///src/views/userManage/Record.vue","webpack:///./src/views/userManage/Record.vue?3b61","webpack:///./src/views/userManage/Record.vue"],"names":["render","_vm","this","_h","$createElement","_c","_self","staticClass","ref","attrs","model","value","query","callback","$$v","$set","expression","_l","item","key","label","value2","table","loading","on","handleQueryClick","_v","handleExportClick","directives","name","rawName","data","formatterTime","pageSize","currentPage","total","handleTablePageCurrentChange","staticRenderFns","sysType","sysList","stime","etime","username","mounted","$nextTick","methods","$confirm","confirmButtonText","cancelButtonText","cancelButtonClass","closeOnClickModal","type","center","queryTable","params","append","timelist","setTimeout","$message","message","val","component"],"mappings":"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","file":"js/chunk-2d0c5214.1642df24.js","sourcesContent":["var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"tw-template-wrapper\"},[_c('el-form',{ref:\"queryBar\",staticClass:\"tw-query-bar\",attrs:{\"inline\":true,\"size\":\"small\"}},[_c('el-form-item',[_c('el-input',{attrs:{\"placeholder\":\"用户名\"},model:{value:(_vm.query.username),callback:function ($$v) {_vm.$set(_vm.query, \"username\", $$v)},expression:\"query.username\"}})],1),_c('el-form-item',[_c('el-select',{attrs:{\"placeholder\":\"请选择系统类型\"},model:{value:(_vm.query.sysType),callback:function ($$v) {_vm.$set(_vm.query, \"sysType\", $$v)},expression:\"query.sysType\"}},_vm._l((_vm.query.sysList),function(item){return _c('el-option',{key:item.value,attrs:{\"label\":item.label,\"value\":item.value}})}),1)],1),_c('el-form-item',[_c('el-date-picker',{attrs:{\"type\":\"datetimerange\",\"align\":\"right\",\"start-placeholder\":\"开始时间\",\"end-placeholder\":\"结束时间\",\"default-time\":['00:00:00', '23:59:59']},model:{value:(_vm.value2),callback:function ($$v) {_vm.value2=$$v},expression:\"value2\"}})],1),_c('el-form-item',[_c('el-button',{attrs:{\"type\":\"primary\",\"loading\":_vm.table.loading},on:{\"click\":_vm.handleQueryClick}},[_vm._v(\"查询\")])],1),_c('el-form-item',[_c('el-button',{attrs:{\"type\":\"primary\"},on:{\"click\":_vm.handleExportClick}},[_vm._v(\"导出\")])],1)],1),_c('div',{ref:\"queryPanel\",staticClass:\"tw-query-panel\"},[_c('el-table',{directives:[{name:\"loading\",rawName:\"v-loading\",value:(_vm.table.loading),expression:\"table.loading\"}],staticClass:\"tw-table\",attrs:{\"stripe\":\"\",\"data\":_vm.table.data,\"border\":\"\",\"height\":\"calc(100% - 42px)\"}},[_c('el-table-column',{attrs:{\"prop\":\"USERNAME\",\"width\":\"200\",\"align\":\"center\",\"label\":\"用户名\"}}),_c('el-table-column',{attrs:{\"prop\":\"HANDLE\",\"width\":\"650\",\"align\":\"center\",\"label\":\"访问模块\"}}),_c('el-table-column',{attrs:{\"label\":\"时间\",\"align\":\"center\",\"min-width\":\"200\",\"resizable\":false,\"formatter\":_vm.formatterTime}})],1),_c('el-pagination',{staticClass:\"tw-page-bar\",attrs:{\"background\":\"\",\"page-size\":_vm.table.pageSize,\"current-page\":_vm.table.currentPage,\"total\":_vm.table.total},on:{\"current-change\":_vm.handleTablePageCurrentChange}})],1)],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\r\n  <div class=\"tw-template-wrapper\">\r\n    <el-form class=\"tw-query-bar\" :inline=\"true\" size=\"small\" ref=\"queryBar\">\r\n      <el-form-item>\r\n        <el-input v-model=\"query.username\" placeholder=\"用户名\"></el-input>\r\n      </el-form-item>\r\n      <el-form-item>\r\n        <el-select v-model=\"query.sysType\" placeholder=\"请选择系统类型\">\r\n          <el-option v-for=\"item in query.sysList\" :key=\"item.value\" :label=\"item.label\" :value=\"item.value\">\r\n          </el-option>\r\n        </el-select>\r\n      </el-form-item>\r\n      <el-form-item>\r\n        <el-date-picker\r\n          v-model=\"value2\"\r\n          type=\"datetimerange\"\r\n          align=\"right\"\r\n          start-placeholder=\"开始时间\"\r\n          end-placeholder=\"结束时间\"\r\n          :default-time=\"['00:00:00', '23:59:59']\"\r\n        >\r\n        </el-date-picker>\r\n      </el-form-item>\r\n      <el-form-item>\r\n        <el-button type=\"primary\" @click=\"handleQueryClick\" :loading=\"table.loading\">查询</el-button>\r\n      </el-form-item>\r\n      <el-form-item>\r\n        <el-button type=\"primary\" @click=\"handleExportClick\">导出</el-button>\r\n      </el-form-item>\r\n    </el-form>\r\n    <div class=\"tw-query-panel\" ref=\"queryPanel\">\r\n      <el-table v-loading=\"table.loading\" stripe class=\"tw-table\" :data=\"table.data\" border height=\"calc(100% - 42px)\">\r\n        <el-table-column prop=\"USERNAME\" width=\"200\" align=\"center\" label=\"用户名\"></el-table-column>\r\n        <el-table-column prop=\"HANDLE\" width=\"650\" align=\"center\" label=\"访问模块\"></el-table-column>\r\n        <el-table-column\r\n          label=\"时间\"\r\n          align=\"center\"\r\n          min-width=\"200\"\r\n          :resizable=\"false\"\r\n          :formatter=\"formatterTime\"\r\n        ></el-table-column>\r\n      </el-table>\r\n      <el-pagination\r\n        class=\"tw-page-bar\"\r\n        background\r\n        :page-size=\"table.pageSize\"\r\n        :current-page=\"table.currentPage\"\r\n        :total=\"table.total\"\r\n        @current-change=\"handleTablePageCurrentChange\"\r\n      ></el-pagination>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport axios from 'axios'\r\nimport moment from 'moment'\r\n\r\nexport default {\r\n  name: 'Record',\r\n  data() {\r\n    return {\r\n      query: {\r\n        sysType: 0,\r\n        sysList: [\r\n          { value: 0, label: '网约车监管服务平台' },\r\n          { value: 1, label: '考试管理系统' },\r\n          { value: 2, label: '申报信息管理系统' },\r\n          { value: 3, label: '互联网申报系统' }\r\n        ],\r\n        stime: '',\r\n        etime: '',\r\n        username: ''\r\n      },\r\n      table: {\r\n        data: [],\r\n        pageSize: 30,\r\n        currentPage: 1,\r\n        total: 0,\r\n        loading: false\r\n      },\r\n      value2: []\r\n    }\r\n  },\r\n  mounted() {\r\n    this.$nextTick(() => {\r\n      this.query.etime = moment().format('YYYY-MM-DD 23:59:59')\r\n      this.query.stime = moment()\r\n        .subtract(1, 'days')\r\n        .format('YYYY-MM-DD 00:00:00')\r\n      this.value2.push(this.query.stime)\r\n      this.value2.push(this.query.etime)\r\n      this.queryTable()\r\n    })\r\n  },\r\n  methods: {\r\n    handleExportClick() {\r\n      this.$confirm('是否需要导出?', '提示', {\r\n        confirmButtonText: '是',\r\n        cancelButtonText: '否',\r\n        cancelButtonClass: 'el-button--danger',\r\n        closeOnClickModal: false,\r\n        type: 'info',\r\n        center: true\r\n      })\r\n        .then(() => {\r\n          const { sysType } = this.query\r\n          let startTime = ''\r\n          let endTime = ''\r\n          if (this.value2) {\r\n            startTime = moment(this.value2[0]).format('YYYY-MM-DD HH:mm:ss')\r\n            ;(endTime = 'etime'), moment(this.value2[1]).format('YYYY-MM-DD HH:mm:ss')\r\n          }\r\n          window.open(`${this.baseURL}user/getLogExcel?condition=${sysType}&stime=${startTime}&etime=${endTime}`)\r\n        })\r\n        .catch(e => {})\r\n    },\r\n    formatterTime(row) {\r\n      return moment(row.DBTIME).format('YYYY-MM-DD HH:mm:ss')\r\n    },\r\n    handleQueryClick() {\r\n      this.queryTable()\r\n    },\r\n    queryTable() {\r\n      const timelist = this.value2\r\n      const baseURL = this.baseURL\r\n      const params = new URLSearchParams()\r\n      if (!this.value2) {\r\n        this.$message({\r\n          message: '请选择时间',\r\n          type: 'warning'\r\n        })\r\n      } else {\r\n        this.table.loading = true\r\n        params.append('condition', this.query.sysType)\r\n        params.append('page', this.table.currentPage)\r\n        params.append('pageSize', this.table.pageSize)\r\n        params.append('username', this.query.username)\r\n        if (timelist) {\r\n          params.append('stime', moment(this.value2[0]).format('YYYY-MM-DD HH:mm:ss'))\r\n          params.append('etime', moment(this.value2[1]).format('YYYY-MM-DD HH:mm:ss'))\r\n        } else {\r\n          params.append('stime', '')\r\n          params.append('etime', '')\r\n        }\r\n        axios.post('user/getLog', params, { baseURL }).then(res => {\r\n          this.table.data = res.data.list\r\n          this.table.total = res.data.count\r\n          setTimeout(() => {\r\n            this.table.loading = false\r\n          }, 500)\r\n        })\r\n      }\r\n    },\r\n    handleTablePageCurrentChange(val) {\r\n      this.table.currentPage = val\r\n      this.queryTable()\r\n    }\r\n  }\r\n}\r\n</script>\r\n\r\n<style scoped></style>\r\n","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Record.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Record.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./Record.vue?vue&type=template&id=686cf58a&scoped=true&\"\nimport script from \"./Record.vue?vue&type=script&lang=js&\"\nexport * from \"./Record.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"686cf58a\",\n  null\n  \n)\n\nexport default component.exports"],"sourceRoot":""}