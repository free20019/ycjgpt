(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-1db044e0"],{3238:function(t,e,a){"use strict";a.r(e);var l=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"tw-template-wrapper"},[a("div",{staticClass:"tw-content-top"},[a("el-row",{staticClass:"tw-row"},[a("el-col",{staticClass:"tw-col",attrs:{span:6}},[a("div",{staticClass:"tw-col-text"},[t._v("申请接入企业："+t._s(t.echartData.total)+"家")])]),a("el-col",{staticClass:"tw-col",attrs:{span:6}},[a("div",{staticClass:"tw-col-text"},[t._v("完成接入企业："+t._s(t.echartData.end)+"家")])]),a("el-col",{staticClass:"tw-col",attrs:{span:6}},[a("div",{staticClass:"tw-col-text"},[t._v("接入中企业："+t._s(t.echartData.online)+"家")])]),a("el-col",{staticClass:"tw-col",attrs:{span:6}},[a("div",{staticClass:"tw-echart",attrs:{id:"echart"}})])],1)],1),a("div",{staticClass:"tw-content-bottom"},[a("el-form",{ref:"queryBar",staticClass:"tw-query-bar",attrs:{inline:!0,model:t.query,size:"small"}},[a("el-form-item",{attrs:{label:"企业名称"}},[a("el-input",{attrs:{clearable:"",placeholder:"企业名称"},model:{value:t.query.qymc,callback:function(e){t.$set(t.query,"qymc",e)},expression:"query.qymc"}})],1),a("el-form-item",{attrs:{label:"接入状态"}},[a("el-select",{staticClass:"tw-block",attrs:{placeholder:"接入状态"},model:{value:t.query.state,callback:function(e){t.$set(t.query,"state",e)},expression:"query.state"}},t._l(t.query.stateOptions,(function(t){return a("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})})),1)],1),a("el-form-item",[a("el-button",{attrs:{type:"primary"},on:{click:t.handleAddClick}},[t._v("新增接入")])],1)],1),a("div",{ref:"queryPanel",staticClass:"tw-query-panel"},[a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.table.loading,expression:"table.loading"}],staticClass:"tw-table",attrs:{data:t.filterTableList,border:"",size:"small",height:"calc(100% - 42px)",stripe:""},on:{"selection-change":t.handleTableSelectionChange}},[a("el-table-column",{attrs:{type:"index",label:"序号",width:"60",align:"center",resizable:!1}}),a("el-table-column",{attrs:{label:"企业编码",prop:"COMPANY_ID",align:"center",width:"250"}}),a("el-table-column",{attrs:{label:"企业名称",prop:"COMPANY",align:"center",width:"250"}}),a("el-table-column",{attrs:{label:"APP名称",prop:"ABB_NAME",align:"center","min-width":"130"}}),a("el-table-column",{attrs:{label:"拟在杭运营规模",prop:"SCALE",align:"center",width:"200"}}),a("el-table-column",{attrs:{label:"开始接入时间",prop:"STIME",formatter:t.formatterTableTime,align:"center",width:"200"}}),a("el-table-column",{attrs:{label:"完成接入时间",prop:"ETIME",formatter:t.formatterTableTime,align:"center",width:"200"}}),a("el-table-column",{attrs:{label:"接入状态",prop:"STATUS",formatter:t.formatterTableState,align:"center",width:"200"}}),a("el-table-column",{attrs:{label:"操作",align:"center","min-width":"150"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-button",{attrs:{type:"primary",plain:"",size:"small"},on:{click:function(a){return t.handleTableClick(e.row)}}},[t._v("编辑")])]}}])})],1),a("el-pagination",{attrs:{background:"","page-size":t.table.pageSize,"current-page":t.table.currentPage,total:t.table.total},on:{"current-change":t.handleTablePageCurrentChange}})],1)],1),a("el-dialog",{attrs:{title:t.dialog.title,visible:t.dialog.display,"close-on-click-modal":!1,"custom-class":"tw-dialog",width:"600px"},on:{"update:visible":function(e){return t.$set(t.dialog,"display",e)},close:t.handleClose}},[a("el-form",{attrs:{"label-width":"110px"}},[a("el-form-item",{attrs:{label:"企业编码"}},[a("el-input",{attrs:{placeholder:"企业名称"},model:{value:t.dialog.form.companyId,callback:function(e){t.$set(t.dialog.form,"companyId",e)},expression:"dialog.form.companyId"}})],1),a("el-form-item",{attrs:{label:"企业名称"}},[a("el-input",{attrs:{placeholder:"企业名称"},model:{value:t.dialog.form.qymc,callback:function(e){t.$set(t.dialog.form,"qymc",e)},expression:"dialog.form.qymc"}})],1),a("el-form-item",{attrs:{label:"APP名称"}},[a("el-input",{attrs:{placeholder:"APP名称"},model:{value:t.dialog.form.appName,callback:function(e){t.$set(t.dialog.form,"appName",e)},expression:"dialog.form.appName"}})],1),a("el-form-item",{attrs:{label:"IP地址白名单"}},[a("el-input",{attrs:{placeholder:"IP地址白名单"},model:{value:t.dialog.form.ip,callback:function(e){t.$set(t.dialog.form,"ip",e)},expression:"dialog.form.ip"}})],1),a("el-form-item",{attrs:{label:"拟在杭运营规模"}},[a("el-input",{attrs:{placeholder:"拟在杭运营规模"},model:{value:t.dialog.form.SCALE,callback:function(e){t.$set(t.dialog.form,"SCALE",e)},expression:"dialog.form.SCALE"}})],1),a("el-form-item",{attrs:{label:"开始接入时间"}},[a("el-date-picker",{attrs:{type:"date",placeholder:"开始接入时间"},model:{value:t.dialog.form.stime,callback:function(e){t.$set(t.dialog.form,"stime",e)},expression:"dialog.form.stime"}})],1),a("el-form-item",{attrs:{label:"完成接入时间"}},[a("el-date-picker",{attrs:{type:"date",placeholder:"完成接入时间"},model:{value:t.dialog.form.etime,callback:function(e){t.$set(t.dialog.form,"etime",e)},expression:"dialog.form.etime"}})],1),a("el-form-item",{attrs:{label:"接入状态"}},[a("el-select",{staticClass:"tw-block",attrs:{placeholder:"接入状态"},model:{value:t.dialog.form.state,callback:function(e){t.$set(t.dialog.form,"state",e)},expression:"dialog.form.state"}},t._l(t.dialog.form.stateOptions,(function(t){return a("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})})),1)],1),a("el-form-item",{attrs:{label:"接入车辆规模"}},[a("el-input",{attrs:{placeholder:"测试阶段接入车辆规模"},model:{value:t.dialog.form.access_scale,callback:function(e){t.$set(t.dialog.form,"access_scale",e)},expression:"dialog.form.access_scale"}})],1)],1),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:t.handleClose}},[t._v("取 消")]),a("el-button",{attrs:{type:"primary"},on:{click:t.submitInfo}},[t._v("确 定")])],1)],1)],1)},i=[],s=a("313e"),o=a.n(s),r=a("bbd5"),n=a("bc3a"),c=a.n(n),d=a("c46f"),m=a("c1df"),f=a.n(m),u={name:"DataAccessManagement",data:function(){return{echart:null,query:{qymc:"",state:"0",stateOptions:[{label:"全部",value:"0"},{label:"接入中",value:"1"},{label:"接入完成",value:"2"}]},echartData:{online:0,end:0,total:0},table:{data:[],loading:!1,pageSize:30,total:0,currentPage:1,selectRow:{},selected:[]},dialog:{title:"",display:!1,form:{companyId:"",qymc:"",appName:"",ip:"",SCALE:"",stime:"",etime:"",state:"",stateOptions:[{label:"接入中",value:"1"},{label:"接入完成",value:"2"}],access_scale:""}}}},computed:{filterTableList:function(){return Object(r["a"])(this.table)}},mounted:function(){var t=this;this.$nextTick((function(){var e=t.$refs["queryBar"].$el;Object(r["d"])(t.$refs["queryPanel"],e),t.getTableDataList(),t.getEchartDataList(),window.addEventListener("resize",(function(){t.echart&&t.echart.resize()}))}))},methods:{handleTableSelectionChange:function(t){this.table.selected=t},getEchartDataList:function(){var t=this,e=this.baseURL;c.a.get("data/getChartInfo",{baseURL:e}).then((function(e){t.echartData.end=e.data.end,t.echartData.online=e.data.online,t.echartData.total=e.data.online+e.data.end,t.initEcharts()}))},formatterTableState:function(t,e,a){return"1"==a?"接入中":"2"==a?"接入完成":""},formatterTableTime:function(t,e,a){return f()(a).format("YYYY-MM-DD")},handleClose:function(){this.dialog.display=!1,this.dialog.form.companyId="",this.dialog.form.qymc="",this.dialog.form.appName="",this.dialog.form.ip="",this.dialog.form.SCALE="",this.dialog.form.stime="",this.dialog.form.etime="",this.dialog.form.state="",this.dialog.form.access_scale=""},submitInfo:function(){var t=this.dialog.form,e=t.companyId,a=t.qymc,l=t.appName,i=t.ip,s=t.SCALE,o=t.stime,r=t.etime,n=t.state,c=t.access_scale;if(a)if(e)if(l)if(s)if(o)if(r)if(n)if(c){var d=new URLSearchParams;d.append("company",a),d.append("company_id",e),d.append("abb_name",l),d.append("ip_addr",i),d.append("scale",s),d.append("stime",f()(o).format("YYYY-MM-DD")),d.append("etime",f()(r).format("YYYY-MM-DD")),d.append("status",n),d.append("access_scale",c),"添加"==this.dialog.title?this.addForm(d):"修改"==this.dialog.title&&this.editForm(d)}else this.$message.error("请输入接入车辆规模!");else this.$message.error("请选择接入状态!");else this.$message.error("请选择完成接入时间!");else this.$message.error("请选择开始接入时间!");else this.$message.error("请输入拟在杭运营规模!");else this.$message.error("请输入APP名称!");else this.$message.error("请输入企业编码!");else this.$message.error("请输入企业名称!")},addForm:function(t){var e=this,a=this.baseURL;c.a.post("data/addData",t,{baseURL:a}).then((function(t){"0"==t.data.msg?(e.$message.success("添加成功"),e.getTableDataList(),e.getEchartDataList(),e.dialog.display=!1):e.$message.error("添加失败")}))},editForm:function(t){var e=this,a=this.baseURL;t.append("id",this.table.selectRow.ID),c.a.post("data/editData",t,{baseURL:a}).then((function(t){"0"==t.data.msg?(e.$message.success("修改成功"),e.getTableDataList(),e.getEchartDataList(),e.dialog.display=!1):e.$message.error("修改失败")}))},handleDelClick:function(){console.info(d["a"].pluck(this.table.selected,"ID"))},handleAddClick:function(){this.dialog.title="添加",this.dialog.display=!0},handleTablePageCurrentChange:function(t){this.table.currentPage=t,this.getTableDataList()},getTableDataList:function(){var t=this;this.table.loading=!0;var e=this.baseURL,a=this.query,l=a.qymc,i=a.state;c.a.get("data/getDataList",{baseURL:e,params:{company:l,status:i}}).then((function(e){t.table.data=e.data.datas,t.table.total=e.data.datas.length,t.table.loading=!1}))},handleTableClick:function(t){this.table.selectRow=t,this.dialog.display=!0,this.dialog.title="修改",this.editShow()},editShow:function(){var t=this.table.selectRow,e=t.COMPANY_ID,a=t.COMPANY,l=t.ABB_NAME,i=t.IP_ADDR,s=t.SCALE,o=t.STIME,r=(t.ETIME,t.STATUS),n=t.ACCESS_SCALE;this.dialog.form.qymc=a,this.dialog.form.companyId=e,this.dialog.form.appName=l,this.dialog.form.ip=i,this.dialog.form.SCALE=s,this.dialog.form.stime=f()(o).format("YYYY-MM-DD"),this.dialog.form.etime=f()(o).format("YYYY-MM-DD"),this.dialog.form.state=r,this.dialog.form.access_scale=n},initEcharts:function(){this.echart=o.a.init(document.getElementById("echart")),this.echart.setOption({tooltip:{trigger:"item",formatter:"{a} <br/>{b} : {c} ({d}%)"},legend:{orient:"vertical",left:"left",data:["接入中","接入完成"]},series:[{name:"访问来源",type:"pie",radius:"55%",center:["50%","60%"],data:[{value:this.echartData.online,name:"接入中"},{value:this.echartData.end,name:"接入完成"}],emphasis:{itemStyle:{shadowBlur:10,shadowOffsetX:0,shadowColor:"rgba(0, 0, 0, 0.5)"}}}]})}}},p=u,h=(a("697c"),a("2877")),g=Object(h["a"])(p,l,i,!1,null,"d7e55f88",null);e["default"]=g.exports},"697c":function(t,e,a){"use strict";var l=a("7838"),i=a.n(l);i.a},7838:function(t,e,a){},bbd5:function(t,e,a){"use strict";a.d(e,"c",(function(){return i})),a.d(e,"b",(function(){return s})),a.d(e,"d",(function(){return o})),a.d(e,"a",(function(){return r}));a("5c96");var l=a("c46f");function i(t){return 0===t.indexOf("icon-")?"iconfont ".concat(t):0===t.indexOf("el-icon-")?t:""}function s(t){var e=0;return t instanceof Array||t.offsetHeight?(t instanceof Array?l["a"].each(t,(function(t){try{e+=parseInt(t.offsetHeight)}catch(a){console.error(a)}})):e=parseInt(t.offsetHeight),"calc(100% - ".concat(e,"px)")):""}function o(t,e,a){a&&a(),t.style.height=s(e),window.addEventListener("resize",(function(){t.style.height=s(e),a&&a()}))}function r(t){var e=t.data,a=t.pageSize,i=t.currentPage,s=i-1;return l["a"].filter(e,(function(t,e){return e>=s*a&&e<i*a}))}}}]);
//# sourceMappingURL=chunk-1db044e0.2f55f49f.js.map