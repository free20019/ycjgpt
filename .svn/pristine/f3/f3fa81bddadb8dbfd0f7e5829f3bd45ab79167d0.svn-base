(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-6622451a"],{3986:function(e,t,a){},4238:function(e,t,a){"use strict";a.r(t);var l=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"tw-template-wrapper"},[a("el-form",{ref:"queryBar",staticClass:"tw-query-bar",attrs:{model:e.query,inline:!0,size:"small"}},[a("el-form-item",[a("el-select",{attrs:{placeholder:"平台名称",clearable:""},model:{value:e.value,callback:function(t){e.value=t},expression:"value"}},e._l(e.info,(function(e){return a("el-option",{key:e.value,attrs:{label:e.platformName,value:e.platformName}})})),1)],1),a("el-form-item",[a("el-autocomplete",{staticClass:"inline-input",attrs:{"fetch-suggestions":e.handleQuerySearch,placeholder:"车牌号码","trigger-on-focus":!1,clearable:""},on:{focus:e.handleCarfocus},model:{value:e.query.vehicleNumber,callback:function(t){e.$set(e.query,"vehicleNumber",t)},expression:"query.vehicleNumber"}})],1),a("el-form-item",[a("el-input",{attrs:{placeholder:"驾驶员证号",clearable:""},model:{value:e.query.driverNumber,callback:function(t){e.$set(e.query,"driverNumber",t)},expression:"query.driverNumber"}})],1),a("el-form-item",[a("el-date-picker",{attrs:{type:"date",placeholder:"开始时间"},model:{value:e.query.stime,callback:function(t){e.$set(e.query,"stime",t)},expression:"query.stime"}})],1),a("el-form-item",[a("el-date-picker",{attrs:{type:"date",placeholder:"结束时间"},model:{value:e.query.etime,callback:function(t){e.$set(e.query,"etime",t)},expression:"query.etime"}})],1),a("el-form-item",[a("el-select",{attrs:{placeholder:"违规类型"},model:{value:e.query.violationType,callback:function(t){e.$set(e.query,"violationType",t)},expression:"query.violationType"}},[a("el-option",{attrs:{label:"人证不符",value:"人证不符"}}),a("el-option",{attrs:{label:"车证不符",value:"车证不符"}}),a("el-option",{attrs:{label:"人车证不符",value:"人车证不符"}})],1)],1),a("el-form-item",[a("el-button",{attrs:{type:"primary"},on:{click:e.handleQueryClick}},[e._v("查询")])],1),a("el-form-item",[a("el-button",{attrs:{type:"primary"},on:{click:e.exportExcel}},[e._v("导出")])],1)],1),a("div",{ref:"queryPanel",staticClass:"tw-query-panel"},[a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.table.loading,expression:"table.loading"}],staticClass:"tw-table",attrs:{data:e.table.data,border:"",height:"calc(100% - 42px)"}},[a("el-table-column",{attrs:{align:"center",type:"index",label:"序号",width:"60"}}),a("el-table-column",{attrs:{align:"center",prop:"DRIVER_NAME",label:"姓名",width:"80"}}),a("el-table-column",{attrs:{align:"center",prop:"DRIVER_NUMBER",label:"驾驶员证号",width:"180"}}),a("el-table-column",{attrs:{align:"center",prop:"VEHICLE_NUMBER",label:"车牌号码",width:"140"}}),a("el-table-column",{attrs:{align:"center",prop:"ABB_NAME",label:"平台名称",width:"180"}}),a("el-table-column",{attrs:{align:"center",prop:"ORDER_NUMBER",label:"订单编号",width:"160"}}),a("el-table-column",{attrs:{align:"center",prop:"VIOLATION_TYPE",label:"违规类型",width:"160"}}),a("el-table-column",{attrs:{align:"center",prop:"START_TIME",label:"订单起始时间",width:"160"}}),a("el-table-column",{attrs:{align:"center",prop:"END_TIME",label:"订单终止时间",width:"160"}}),a("el-table-column",{attrs:{align:"center",prop:"START_POSITION",label:"订单起点",width:"140"}}),a("el-table-column",{attrs:{align:"center",prop:"END_POSITION",label:"订单终点",width:"140"}}),a("el-table-column",{attrs:{align:"center",prop:"ORDER_MONEY",label:"订单金额/元",width:"140"}})],1),a("el-pagination",{attrs:{background:"","page-size":e.table.pageSize,"current-page":e.table.currentPage,total:e.table.total},on:{"current-change":e.handleTablePageCurrentChange}})],1),a("el-dialog",{attrs:{title:"导出",visible:e.dialogVisible,width:"30%"},on:{"update:visible":function(t){e.dialogVisible=t}}},[a("el-form",{attrs:{model:e.dialog.form,"label-width":"80px"}},[a("el-form-item",{attrs:{label:"导出类型"}},[a("el-radio",{attrs:{label:"1",border:""},on:{change:e.changeList},model:{value:e.dialog.radio1,callback:function(t){e.$set(e.dialog,"radio1",t)},expression:"dialog.radio1"}},[e._v("默认")]),a("el-radio",{attrs:{label:"2",border:""},on:{change:e.changeList},model:{value:e.dialog.radio1,callback:function(t){e.$set(e.dialog,"radio1",t)},expression:"dialog.radio1"}},[e._v("自定义")])],1),a("el-form-item",{directives:[{name:"show",rawName:"v-show",value:e.dialog.display,expression:"dialog.display"}],attrs:{label:"导出列表"}},[a("el-select",{attrs:{multiple:"",placeholder:"请选择",clearable:!0},model:{value:e.dialog.list,callback:function(t){e.$set(e.dialog,"list",t)},expression:"dialog.list"}},e._l(e.filedList,(function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1)],1),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.dialogVisible=!1}}},[e._v("取 消")]),a("el-button",{attrs:{type:"primary"},on:{click:e.exportExcle}},[e._v("导 出")])],1)],1)],1)},i=[],r=a("bc3a"),n=a.n(r),o=a("c1df"),s=a.n(o),c=a("c46f"),u=a("bbd5"),d={name:"ViolationOperationAnalysis",data:function(){return{info:[{platformName:"全部选择",vehicleNumber:"",driverNumber:"",violationType:"",stime:"",etime:"",value:"全部选择"}],query:{platformName:"",vehicleNumber:"",driverNumber:"",violationType:"",stime:"",etime:"",value:""},table:{loading:!1,data:[],pageSize:20,currentPage:1,total:0},count:1,value:"全部选择",dialogVisible:!1,dialog:{radio1:"1",list:[],display:!1},filedList:[{value:"DRIVER_NAME",label:"驾驶员姓名"},{value:"DRIVER_NUMBER",label:"驾驶员证号"},{value:"VEHICLE_NUMBER",label:"车牌号码"},{value:"ABB_NAME",label:"平台公司"},{value:"ORDER_NUMBER",label:"订单编号"},{value:"VIOLATION_TYPE",label:"违规类型"},{value:"STIME",label:"订单开始时间"},{value:"ETIME",label:"订单结束时间"},{value:"START_POSITION",label:"订单起点"},{value:"END_POSITION",label:"订单终点"},{value:"ORDER_MONEY",label:"订单金额"}]}},mounted:function(){var e=this;this.$nextTick((function(){var t=e.$refs["queryBar"].$el;Object(u["d"])(e.$refs["queryPanel"],t),e.query.stime=s()().subtract(1,"days").format("YYYY-MM-DD"),e.query.etime=s()().subtract(1,"days").format("YYYY-MM-DD"),e.getViolationOperationAnalysis(),e.getPlatformName()}))},methods:{getViolationOperationAnalysis:function(){var e=this,t=this.query,a=t.vehicleNumber,l=t.driverNumber,i=t.violationType,r=t.stime,o=t.etime;if(""!==r&&r&&""!==o&&o){this.table.loading=!0;var c="";"全部选择"!=this.value&&(c=this.value);var u=this.table,d=u.currentPage,b=u.pageSize;n.a.get("getOperationAndWarningAction/getViolationOperationAnalysis",{baseURL:this.baseURL,params:{platformName:c,vehicleNumber:a,driverNumber:l,violationType:i,page:d,pageSize:b,sTime:r&&s()(r).format("YYYY-MM-DD"),eTime:o&&s()(o).format("YYYY-MM-DD")}}).then((function(t){e.table.data=t.data.datas||[],e.table.total=t.data.count,e.table.loading=!1}))}else this.$message({message:"时间不能为空！",type:"warning"})},getPlatformName:function(){var e=this;this.table.loading=!0,n.a.get("getOperationAndWarningAction/getPlatformName",{baseURL:this.baseURL,params:{}}).then((function(t){c["a"].each(t.data,(function(t){var a={};""!=t.ABB_NAME&&(a.platformName=t.ABB_NAME,a.value=e.count++,e.info.push(a))})),e.table.loading=!1}))},handleQuerySearch:function(e,t){var a=[];if(e.length>=5){var l="postData={'vehicle_number':'".concat(this.query.vehicleNumber,"','time':'").concat(this.query.stime,"'}");n.a.post("getOperationAndWarningAction/getViolationOperationAnalysisVehicleNumber",l,{baseURL:this.baseURL}).then((function(e){for(var l=0;l<e.data.length;l++)a.push({value:e.data[l].VEHICLE_NUMBER});t(a)}))}},handleCarfocus:function(){""===this.query.vehicleNumber&&(this.query.vehicleNumber="浙A")},handleQueryClick:function(){this.table.currentPage=1,this.getViolationOperationAnalysis()},handleTablePageCurrentChange:function(e){this.table.currentPage=e,this.getViolationOperationAnalysis()},cellStyle:function(){return"text-align:center;"},exportExcel:function(){this.dialogVisible=!0,this.dialog.radio1="1",this.dialog.list=[],this.dialog.display=!1},changeList:function(){"1"==this.dialog.radio1?this.dialog.display=!1:this.dialog.display=!0},exportExcle:function(){var e=this.dialog,t=e.list,a=e.radio1,l=c["a"].filter(this.filedList,(function(e){return-1!=t.indexOf(e.value)}));if("2"!=a||0!=l.length){var i="",r="";c["a"].map(l,(function(e){i+=e.label+",",r+=e.value+","})),r=r.substring(0,r.length-1),i=i.substring(0,i.length-1),this.dialogVisible=!1;var n=this.query,o=(n.platformName,n.vehicleNumber),u=n.driverNumber,d=n.violationType,b=n.stime,m=n.etime;window.open("".concat(this.baseURL,"getOperationAndWarningAction/getViolationOperationAnalysisExcel?platformName=").concat(this.value,"&vehicleNumber=").concat(o,"&driverNumber=").concat(u,"&violationType=").concat(d,"&sTime=").concat(b&&s()(b).format("YYYY-MM-DD"),"&eTime=").concat(m&&s()(m).format("YYYY-MM-DD"),"\n              &type=").concat(a,"&filedLabel=").concat(i,"&filedValue=").concat(r))}else this.$message.error("导出列表不能为空！")}},watch:{"$route.path":{handler:function(e,t){this.query.stime=s()().subtract(1,"days").format("YYYY-MM-DD"),this.query.etime=s()().subtract(1,"days").format("YYYY-MM-DD"),this.getViolationOperationAnalysis()}}}},b=d,m=(a("8082"),a("2877")),p=Object(m["a"])(b,l,i,!1,null,"a55d4dd8",null);t["default"]=p.exports},8082:function(e,t,a){"use strict";var l=a("3986"),i=a.n(l);i.a},bbd5:function(e,t,a){"use strict";a.d(t,"c",(function(){return i})),a.d(t,"b",(function(){return r})),a.d(t,"d",(function(){return n})),a.d(t,"a",(function(){return o}));a("5c96");var l=a("c46f");function i(e){return 0===e.indexOf("icon-")?"iconfont ".concat(e):0===e.indexOf("el-icon-")?e:""}function r(e){var t=0;return e instanceof Array||e.offsetHeight?(e instanceof Array?l["a"].each(e,(function(e){try{t+=parseInt(e.offsetHeight)}catch(a){console.error(a)}})):t=parseInt(e.offsetHeight),"calc(100% - ".concat(t,"px)")):""}function n(e,t,a){a&&a(),e.style.height=r(t),window.addEventListener("resize",(function(){e.style.height=r(t),a&&a()}))}function o(e){var t=e.data,a=e.pageSize,i=e.currentPage,r=i-1;return l["a"].filter(t,(function(e,t){return t>=r*a&&t<i*a}))}}}]);
//# sourceMappingURL=chunk-6622451a.17686af6.js.map